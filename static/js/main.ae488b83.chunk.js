(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(18),o=n.n(s),i=n(7),r=(n(29),n(22)),l=n(2),u=n(3),p=n.p+"static/media/logo.bbe2a6ea.svg",j=n(0);var d=Object(u.h)((function(e){var t=e.setLoggedIn,n=e.history,a=e.loggedIn,s=Object(c.useState)(!1),o=Object(l.a)(s,2),r=o[0],d=o[1],b="header__burger-menu".concat(r?" header__burger-menu_opened":""),h="header__user-container header__user-container_mobile".concat(r?" header__user-container_opened":"");function m(){localStorage.removeItem("jwt"),localStorage.removeItem("email"),t(!1),n.push("/sign-in")}var _=Object(u.g)();return Object(j.jsxs)("header",{className:"header",children:[a&&Object(j.jsxs)("div",{className:h,children:[Object(j.jsx)("span",{className:"header__user-email",children:localStorage.email}),Object(j.jsx)(i.b,{to:"/sign-in",className:"header__user-email",onClick:m,children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(j.jsxs)("div",{className:"header__container",children:[Object(j.jsx)("img",{src:p,alt:"\u041c\u0435\u0441\u0442\u043e \u0420\u043e\u0441\u0441\u0438\u044f",className:"header__logo"}),function(e){return"/"===e.pathname?Object(j.jsxs)("div",{className:"header__user-container",children:[Object(j.jsx)("span",{className:"header__user-email",children:localStorage.email}),Object(j.jsx)(i.b,{to:"/sign-in",className:"header__link",onClick:m,children:"\u0412\u044b\u0439\u0442\u0438"})]}):"/sign-in"===e.pathname?Object(j.jsx)(i.b,{to:"/sign-up",className:"header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}):"/sign-up"===e.pathname?Object(j.jsx)(i.b,{to:"/sign-in",className:"header__link",children:"\u0412\u043e\u0439\u0442\u0438"}):void 0}(_),a&&Object(j.jsx)("div",{className:b,onClick:function(){d(!r)}})]})]})})),b=Object(c.createContext)();var h=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,s=e.onCardDelete,o=Object(c.useContext)(b),i=t.owner._id===o._id,r="element__btn-delete btn ".concat(i?"element__btn-delete_visible":"element__btn-delete_hidden"),l=t.likes.some((function(e){return e._id===o._id})),u="element__btn-like btn ".concat(l&&"element__btn-like_active");return Object(j.jsxs)("li",{className:"element",children:[Object(j.jsx)("div",{className:"element__image",style:{backgroundImage:"url(".concat(t.link,")")},onClick:function(){n(t)}}),Object(j.jsx)("button",{type:"button",className:r,onClick:function(){s(t)}}),Object(j.jsxs)("div",{className:"element__container",children:[Object(j.jsx)("h2",{className:"element__location",children:t.name}),Object(j.jsxs)("div",{className:"element__like-container",children:[Object(j.jsx)("button",{type:"button",className:u,onClick:function(){a(t)}}),Object(j.jsx)("span",{className:"element__like-counter",children:t.likes.length})]})]})]})};var m=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,s=e.cards,o=e.onCardClick,i=e.onCardLike,r=e.onCardDelete,l=Object(c.useContext)(b);return Object(j.jsxs)("main",{className:"content",children:[Object(j.jsxs)("section",{className:"profile",children:[Object(j.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(l.avatar,")")},onClick:t}),Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsxs)("div",{className:"profile__info-container",children:[Object(j.jsx)("h1",{className:"profile__full-name",children:l.name}),Object(j.jsx)("button",{type:"button",className:"profile__btn-edit btn",onClick:n})]}),Object(j.jsx)("p",{className:"profile__description",children:l.about})]}),Object(j.jsx)("button",{type:"button",className:"profile__btn-add btn",onClick:a})]}),Object(j.jsx)("section",{className:"elements",children:Object(j.jsx)("ul",{className:"elements__container",children:s.map((function(e){return Object(j.jsx)(h,{card:e,onCardClick:o,onCardLike:i,onCardDelete:r},e._id)}))})})]})};var _=function(){return Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var f=function(e){var t=e.isOpen,n=e.onClose,c=e.onSubmit,a=e.children,s=e.submit,o=e.name,i=e.title;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"popup popup_overlay_form popup_type_".concat(o).concat(t?" popup_opened":""),children:[Object(j.jsx)("div",{className:"popup__container",children:Object(j.jsxs)("form",{className:"popup__form popup__form_type_".concat(o),onSubmit:c,children:[Object(j.jsx)("h2",{className:"popup__title",children:i}),a,Object(j.jsx)("button",{type:"submit",className:"popup__button btn",children:s})]})}),Object(j.jsx)("button",{type:"button",className:"popup__btn-close btn",onClick:n})]})})};var O=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,s=Object(c.useState)(""),o=Object(l.a)(s,2),i=o[0],r=o[1],u=Object(c.useState)(""),p=Object(l.a)(u,2),d=p[0],h=p[1],m=Object(c.useContext)(b);return Object(c.useEffect)((function(){r(m.name),h(m.about)}),[m]),Object(j.jsxs)(f,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submit:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:i,about:d}),n(),r(""),h("")},children:[Object(j.jsx)("input",{type:"text",name:"name",className:"popup__input",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",autoComplete:"off",value:i||"",onChange:function(e){r(e.target.value)}}),Object(j.jsx)("span",{className:"popup__input-error"}),Object(j.jsx)("input",{type:"text",name:"about",className:"popup__input",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",autoComplete:"off",value:d||"",onChange:function(e){h(e.target.value)}}),Object(j.jsx)("span",{className:"popup__input-error"})]})};var g=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,s=Object(c.useRef)();return Object(j.jsxs)(f,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submit:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:s.current.value}),n(),e.target.reset()},children:[Object(j.jsx)("input",{type:"url",name:"avatar",className:"popup__input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",required:!0,autoComplete:"off",ref:s}),Object(j.jsx)("span",{className:"popup__input-error"})]})};var x=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddPlace,s=Object(c.useState)(""),o=Object(l.a)(s,2),i=o[0],r=o[1],u=Object(c.useState)(""),p=Object(l.a)(u,2),d=p[0],b=p[1];return Object(j.jsxs)(f,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submit:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:i,link:d}),n(),r(""),b("")},children:[Object(j.jsx)("input",{type:"text",name:"name",className:"popup__input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"30",autoComplete:"off",value:i||"",onChange:function(e){r(e.target.value)}}),Object(j.jsx)("span",{className:"popup__input-error"}),Object(j.jsx)("input",{type:"url",name:"link",className:"popup__input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",required:!0,autoComplete:"off",value:d||"",onChange:function(e){b(e.target.value)}}),Object(j.jsx)("span",{className:"popup__input-error"})]})};var v=function(e){var t=e.card,n=e.onClose;return Object(j.jsxs)("div",{className:"popup popup_overlay_image".concat(t?" popup_opened":""),children:[Object(j.jsxs)("div",{className:"popup__container popup__container_image",children:[Object(j.jsx)("img",{className:"popup__image",src:t?t.link:"",alt:t?t.name:""}),Object(j.jsx)("p",{className:"popup__description",children:t?t.name:""})]}),Object(j.jsx)("button",{type:"button",className:"popup__btn-close btn",onClick:n})]})};var C=function(e){var t=e.isOpen,n=e.onClose,c=e.onDeleteCard;return Object(j.jsx)(f,{name:"delete ",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submit:"\u0414\u0430",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(t),n()}})},N=n(20),k=n(21),y=new(function(){function e(t){var n=t.baseUrl,c=t.headers;Object(N.a)(this,e),this._baseUrl=n,this._headers=c}return Object(k.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"like",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}},{key:"dislike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-20",headers:{authorization:"5e9e6ed0-2e3b-49ef-bceb-982a1b5626d9","Content-Type":"application/json"}}),S="https://auth.nomoreparties.co";var I=Object(u.h)((function(e){var t=e.handleLogin,n=e.history,a=Object(c.useState)(""),s=Object(l.a)(a,2),o=s[0],i=s[1],r=Object(c.useState)(""),u=Object(l.a)(r,2),p=u[0],d=u[1];function b(e){"email"===e.target.name?i(e.target.value):d(e.target.value)}return Object(j.jsxs)("div",{className:"sign",children:[Object(j.jsx)("h2",{className:"sign__title",children:"\u0412\u0445\u043e\u0434"}),Object(j.jsxs)("form",{className:"sign__form",onSubmit:function(e){e.preventDefault(),o&&p&&function(e,t){return fetch("".concat(S,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.token?(localStorage.setItem("jwt",e.token),e):void 0})).catch((function(e){return console.log(e)}))}(o,p).then((function(e){e.token&&(i(""),d(""),t(),n.push("/"))})).catch((function(e){return console.log(e)}))},children:[Object(j.jsx)("input",{className:"sign__input",type:"email",name:"email",placeholder:"Email",value:o||"",onChange:b}),Object(j.jsx)("input",{className:"sign__input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:p||"",onChange:b}),Object(j.jsx)("button",{className:"sign__button btn",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}));var U=Object(u.h)((function(e){var t=e.setIsSuccessRegistration,n=e.setIsErrorRegistration,a=e.history,s=Object(c.useState)(""),o=Object(l.a)(s,2),r=o[0],u=o[1],p=Object(c.useState)(""),d=Object(l.a)(p,2),b=d[0],h=d[1];function m(e){"email"===e.target.name?u(e.target.value):h(e.target.value)}return Object(j.jsxs)("div",{className:"sign",children:[Object(j.jsx)("h2",{className:"sign__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("form",{className:"sign__form",onSubmit:function(e){e.preventDefault(),b&&(u(r),h(b),function(e,t){return fetch("".concat(S,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){return console.log(e)}))}(r,b).then((function(e){e?(t(!0),a.push("/sign-in")):n(!0)})).catch((function(e){n(!0),console.log(e)})))},children:[Object(j.jsx)("input",{className:"sign__input",type:"email",name:"email",placeholder:"Email",value:r||"",onChange:m}),Object(j.jsx)("input",{className:"sign__input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:b||"",onChange:m}),Object(j.jsx)("button",{className:"sign__button btn",type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(j.jsx)(i.b,{to:"/sign-in",className:"sign__link",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})})),E=n(23),L=n(24),P=function(e){var t=e.component,n=Object(L.a)(e,["component"]);return Object(j.jsx)(u.b,{children:function(){return n.loggedIn?Object(j.jsx)(t,Object(E.a)({},n)):Object(j.jsx)(u.a,{to:"./sign-in"})}})},T=n.p+"static/media/success.a9eb6caf.svg",D=n.p+"static/media/failed.d0f413bf.svg";function R(e){var t=e.isOpen,n=e.image,c=e.text,a=e.onClose;return Object(j.jsxs)("div",{className:"popup popup_overlay".concat(t?" popup_opened":""),children:[Object(j.jsxs)("div",{className:"popup__container popup__container_info",children:[Object(j.jsx)("div",{className:"popup__image-info",style:{backgroundImage:"url(".concat(n?T:D,")")}}),Object(j.jsx)("p",{className:"popup__text",children:c})]}),Object(j.jsx)("button",{type:"button",className:"popup__btn-close btn",onClick:a})]})}var w=Object(u.h)((function(e){var t=Object(c.useState)(!1),n=Object(l.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!1),i=Object(l.a)(o,2),p=i[0],h=i[1],f=Object(c.useState)(!1),N=Object(l.a)(f,2),k=N[0],E=N[1],L=Object(c.useState)(null),T=Object(l.a)(L,2),D=T[0],w=T[1],A=Object(c.useState)(null),J=Object(l.a)(A,2),q=J[0],F=J[1],B=Object(c.useState)(!1),G=Object(l.a)(B,2),z=G[0],H=G[1],M=Object(c.useState)([]),K=Object(l.a)(M,2),Q=K[0],V=K[1],W=Object(c.useState)(!1),X=Object(l.a)(W,2),Y=X[0],Z=X[1],$=Object(c.useState)(!1),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(!1),ae=Object(l.a)(ce,2),se=ae[0],oe=ae[1];function ie(){s(!1),h(!1),E(!1),w(!1),F(!1)}return Object(c.useEffect)((function(){return y.getUserInfo().then((function(e){return H(e)})).catch((function(e){return console.log(e)}))}),[]),Object(c.useEffect)((function(){return y.getInitialCards().then((function(e){return V(e)})).catch((function(e){return console.log(e)}))}),[]),Object(c.useEffect)((function(){var t,n=localStorage.getItem("jwt");n&&(t=n,fetch("".concat(S,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){return localStorage.setItem("email",e.data.email),e})).catch((function(e){return console.log(e)}))).then((function(t){t&&(Z(!0),e.history.push("/"))}))}),[]),Object(j.jsxs)(b.Provider,{value:z,children:[Object(j.jsx)(d,{loggedIn:Y,setLoggedIn:Z}),Object(j.jsx)("main",{className:"content",children:Object(j.jsxs)(u.d,{children:[Object(j.jsx)(P,{exact:!0,path:"/",loggedIn:Y,component:m,cards:Q,onEditProfile:function(){s(!0)},onAddPlace:function(){h(!0)},onEditAvatar:function(){E(!0)},onCardDelete:function(e){w(e)},onCardClick:F,onCardLike:function(e){e.likes.some((function(e){return e._id===z._id}))?y.dislike(e._id).then((function(t){return V((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)})):y.like(e._id).then((function(t){return V((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))}}),Object(j.jsx)(u.b,{path:"/sign-in",children:Object(j.jsx)(I,{handleLogin:function(){Z(!0)}})}),Object(j.jsx)(u.b,{path:"/sign-up",children:Object(j.jsx)(U,{setIsSuccessRegistration:oe,setIsErrorRegistration:ne})})]})}),Object(j.jsx)(O,{isOpen:a,onClose:ie,onUpdateUser:function(e){y.setUserInfo(e).then((function(e){return H(e)})).catch((function(e){return console.log(e)}))}}),Object(j.jsx)(x,{isOpen:p,onClose:ie,onAddPlace:function(e){y.postCard(e).then((function(e){return V([e].concat(Object(r.a)(Q)))})).catch((function(e){return console.log(e)}))}}),Object(j.jsx)(g,{isOpen:k,onClose:ie,onUpdateAvatar:function(e){y.setUserAvatar(e).then((function(e){return H(e)})).catch((function(e){return console.log(e)}))}}),Object(j.jsx)(C,{isOpen:D,onClose:ie,onDeleteCard:function(e){y.deleteCard(e._id).then((function(){return V(Q.filter((function(t){return t._id!==e._id})))})).catch((function(e){return console.log(e)}))}}),Object(j.jsx)(v,{card:q,onClose:ie}),Object(j.jsx)(R,{text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",image:!0,isOpen:se,onClose:function(){oe(!1),e.history.push("/sign-in")}}),Object(j.jsx)(R,{text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",image:!1,isOpen:te,onClose:function(){ne(!1)}}),Object(j.jsx)(_,{})]})})),A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),s(e),o(e)}))};o.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(i.a,{children:Object(j.jsx)(w,{})})}),document.getElementById("root")),A()}},[[36,1,2]]]);
//# sourceMappingURL=main.ae488b83.chunk.js.map